<!-- Google Fonts: Space Grotesk & IBM Plex Mono -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&family=IBM+Plex+Mono:wght@400;500;600;700&display=swap" rel="stylesheet">

<script>
  // PostHog
  !function (t, e) { var o, n, p, r; e.__SV || (window.posthog = e, e._i = [], e.init = function (i, s, a) { function g(t, e) { var o = e.split("."); 2 == o.length && (t = t[o[0]], e = o[1]), t[e] = function () { t.push([e].concat(Array.prototype.slice.call(arguments, 0))) } } (p = t.createElement("script")).type = "text/javascript", p.crossOrigin = "anonymous", p.async = !0, p.src = s.api_host.replace(".i.posthog.com", "-assets.i.posthog.com") + "/static/array.js", (r = t.getElementsByTagName("script")[0]).parentNode.insertBefore(p, r); var u = e; for (void 0 !== a ? u = e[a] = [] : a = "posthog", u.people = u.people || [], u.toString = function (t) { var e = "posthog"; return "posthog" !== a && (e += "." + a), t || (e += " (stub)"), e }, u.people.toString = function () { return u.toString(1) + ".people (stub)" }, o = "init Re Os As Pe Ms Fs capture Ve calculateEventProperties js register register_once register_for_session unregister unregister_for_session qs getFeatureFlag getFeatureFlagPayload isFeatureEnabled reloadFeatureFlags updateEarlyAccessFeatureEnrollment getEarlyAccessFeatures on onFeatureFlags onSurveysLoaded onSessionId getSurveys getActiveMatchingSurveys renderSurvey canRenderSurvey canRenderSurveyAsync identify setPersonProperties group resetGroups setPersonPropertiesForFlags resetPersonPropertiesForFlags setGroupPropertiesForFlags resetGroupPropertiesForFlags reset get_distinct_id getGroups get_session_id get_session_replay_url alias set_config startSessionRecording stopSessionRecording sessionRecordingStarted captureException loadToolbar get_property getSessionProperty zs Ls createPersonProfile Us Rs Bs opt_in_capturing opt_out_capturing has_opted_in_capturing has_opted_out_capturing clear_opt_in_out_capturing Ds debug I Ns getPageViewId captureTraceFeedback captureTraceMetric".split(" "), n = 0; n < o.length; n++)g(u, o[n]); e._i.push([i, s, a]) }, e.__SV = 1) }(document, window.posthog || []);
  posthog.init('phc_MrAAAWfjIrmzC8OHWp4uJWpv6lHCc4U2Hu8NDgyxCrl', {
    api_host: 'https://phte.groq.io', // your managed reverse proxy domain
    ui_host: 'https://us.i.posthog.com', // necessary because you're using a proxy, this way links will point back to PostHog properly
    defaults: '2025-05-24',
    person_profiles: 'identified_only', // or 'always' to create profiles for anonymous users as well
  })
</script>

<script>
  // Auto-submit OIDC confirmation form (works on non-Ember pages)
  (function() {
    function autoSubmitOIDCForm() {
      var simpleContainer = document.getElementById('simple-container');
      if (simpleContainer) {
        var heading = simpleContainer.querySelector('h2');
        var form = simpleContainer.querySelector('form');
        var button = form ? form.querySelector('button[type="submit"]') : null;
        
        // Check if this is the OIDC confirmation page
        if (heading && heading.textContent.indexOf('Log in using') !== -1 && button) {
          console.log('[Groq OIDC] Auto-clicking OIDC confirmation button');
          button.click();
          return true;
        }
      }
      return false;
    }

    // Try immediately on DOM ready
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', function() {
        setTimeout(function() { autoSubmitOIDCForm(); }, 100);
        setTimeout(function() { autoSubmitOIDCForm(); }, 500);
      });
    } else {
      // DOM is already ready
      setTimeout(function() { autoSubmitOIDCForm(); }, 100);
      setTimeout(function() { autoSubmitOIDCForm(); }, 500);
      setTimeout(function() { autoSubmitOIDCForm(); }, 1000);
    }
  })();
</script>

<script>
  // Global OIDC redirect for all login/signup buttons (works on ALL pages including 404)
  (function() {
    function interceptAuthButtons() {
      // Cast a wider net to catch all possible signup/login buttons
      var buttons = document.querySelectorAll('.login-button, .sign-up-button, .signup-button, a[href="/login"], a[href="/signup"], button.sign-up-button, button.signup-button, button.login-button');
      
      // Check if we have both signup and login buttons
      var hasSignup = false;
      var hasLogin = false;
      var loginButtons = [];
      var signupButtons = [];
      
      buttons.forEach(function(button) {
        if (button.classList.contains('sign-up-button') || button.classList.contains('signup-button') || button.getAttribute('href') === '/signup') {
          hasSignup = true;
          signupButtons.push(button);
        }
        if (button.classList.contains('login-button') || button.getAttribute('href') === '/login') {
          hasLogin = true;
          loginButtons.push(button);
        }
      });
      
      // Determine which button to keep visible
      // Priority: signup button if it exists, otherwise login button
      var buttonToKeep = null;
      if (hasSignup) {
        buttonToKeep = signupButtons[0]; // Keep first signup button
      } else if (hasLogin) {
        buttonToKeep = loginButtons[0]; // Keep first login button if no signup
      }
      
      buttons.forEach(function(button) {
        // Skip if already processed
        if (button.dataset.groqOidcProcessed) return;
        
        // Only process and show the button we want to keep
        if (button === buttonToKeep) {
          button.dataset.groqOidcProcessed = 'true';
          
          // Change ALL signup and login button text to "Sign in with Groq"
          if (button.classList.contains('sign-up-button') || 
              button.classList.contains('signup-button') || 
              button.classList.contains('login-button') ||
              button.getAttribute('href') === '/signup' ||
              button.getAttribute('href') === '/login') {
            
            // Try multiple methods to change the text
            var buttonText = button.querySelector('.d-button-label');
            if (buttonText) {
              buttonText.textContent = 'Sign in with Groq';
            } else if (!button.querySelector('.d-icon') && !button.querySelector('svg')) {
              // If there's no icon, just replace the text content
              button.textContent = 'Sign in with Groq';
            } else if (button.querySelector('.d-icon') || button.querySelector('svg')) {
              // If there's an icon, try to find and replace just the text node
              var textNode = Array.from(button.childNodes).find(function(node) {
                return node.nodeType === Node.TEXT_NODE && node.textContent.trim();
              });
              if (textNode) {
                textNode.textContent = 'Sign in with Groq';
              }
            }
          }
        } else {
          // Hide all other auth buttons by NOT setting the processed flag
          // CSS will keep them hidden since they don't have data-groq-oidc-processed="true"
          return;
        }
        
        // Intercept click and redirect to OIDC
        button.addEventListener('click', function(e) {
          // Only intercept if user is not logged in
          var isAnon = document.documentElement.classList.contains('anon') || !document.querySelector('.current-user');
          if (!isAnon) return;
          
          console.log('[Groq OIDC] Intercepting auth button, redirecting to OIDC');
          e.preventDefault();
          e.stopPropagation();
          
          // Redirect to OIDC endpoint
          var oidcUrl = '/auth/oidc?origin=' + encodeURIComponent(window.location.href);
          window.location.href = oidcUrl;
        }, true);
      });
    }

    // Run on DOM ready
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', function() {
        interceptAuthButtons();
        // Re-run after short delays to catch dynamically added buttons
        setTimeout(interceptAuthButtons, 100);
        setTimeout(interceptAuthButtons, 500);
        setTimeout(interceptAuthButtons, 1000);
      });
    } else {
      // DOM is already ready
      interceptAuthButtons();
      setTimeout(interceptAuthButtons, 100);
      setTimeout(interceptAuthButtons, 500);
      setTimeout(interceptAuthButtons, 1000);
    }
    
    // Also observe DOM changes to catch any dynamically added buttons
    var observer = new MutationObserver(function(mutations) {
      interceptAuthButtons();
    });
    observer.observe(document.body, { childList: true, subtree: true });
  })();
</script>

<!-- Iconify for icons in published components -->
<script src="https://code.iconify.design/3/3.1.1/iconify.min.js"></script>

<meta id="groqsters-pub-config"
  data-enabled="{{theme-setting 'published_enable_customizations'}}"
  data-hide-header="{{theme-setting 'published_hide_default_header'}}"
  data-menu-links="{{theme-setting 'published_menu_links'}}"
>


<!-- <script>
(function(){
  console.log('groqster is locked and loaded');
  function onReady(fn){ if(document.readyState==='loading'){ document.addEventListener('DOMContentLoaded', fn); } else { fn(); } }
  function isPublished(){ return !!(document.body && (document.body.classList.contains('published-page') || document.querySelector('.published-page-content-body'))); }
  function getCfgEl(){ var el=document.getElementById('groqsters-pub-config'); if(el) return el; var head=document.head||document.getElementsByTagName('head')[0]||document.documentElement; var meta=document.createElement('meta'); meta.id='groqsters-pub-config'; var win=window.groqstersPublishedConfig||{}; try{ if(typeof win.enabled==='boolean') meta.dataset.enabled=String(win.enabled); if(typeof win.hideHeader==='boolean') meta.dataset.hideHeader=String(win.hideHeader); if(typeof win.menuLinks==='string') meta.dataset.menuLinks=win.menuLinks; if(typeof win.counter==='boolean') meta.dataset.counter=String(win.counter); if(typeof win.galleryImages==='string') meta.dataset.galleryImages=win.galleryImages; if(typeof win.spaEnabled==='boolean') meta.dataset.spaEnabled=String(win.spaEnabled); if(typeof win.spaSelector==='string') meta.dataset.spaSelector=win.spaSelector; }catch(e){} if(head) head.appendChild(meta); return meta; }
  function readStr(el,key,fallback){ try{ var v=(el && el.dataset && el.dataset[key])||''; if(!v||v.indexOf('{{')===0) return fallback; return v; } catch(e){ return fallback; } }
  function readBool(el,key,fallback){ var v=readStr(el,key,''); if(!v) return fallback; var s=String(v).toLowerCase(); if(s==='true'||s==='1'||s==='yes') return true; if(s==='false'||s==='0'||s==='no') return false; return fallback; }
  function buildConfig(){ var el=getCfgEl(); var win=window.groqstersPublishedConfig||{}; return { enabled: (typeof win.enabled==='boolean') ? win.enabled : readBool(el,'enabled',true), hideHeader: (typeof win.hideHeader==='boolean') ? win.hideHeader : readBool(el,'hideHeader',false), menuLinks: (typeof win.menuLinks==='string') ? win.menuLinks : readStr(el,'menuLinks','Home|/, Forum|/latest, Docs|/docs'), counter: (typeof win.counter==='boolean') ? win.counter : readBool(el,'counter',true), galleryImages: (typeof win.galleryImages==='string') ? win.galleryImages : readStr(el,'galleryImages',''), spaEnabled: (typeof win.spaEnabled==='boolean') ? win.spaEnabled : readBool(el,'spaEnabled',false), spaSelector: (typeof win.spaSelector==='string') ? win.spaSelector : readStr(el,'spaSelector','.groqsters-published-menu a') }; }
  function bootstrap(){ if(!isPublished()) return; var cfg=buildConfig(); window.groqstersPublished=window.groqstersPublished||{}; window.groqstersPublished.isPublished=isPublished; window.groqstersPublished.getConfig=function(){ return buildConfig(); }; try{ window.dispatchEvent(new CustomEvent('groqsters:published:config',{detail:cfg})); }catch(e){} }
  onReady(bootstrap);
})(); -->
</script>

